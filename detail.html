<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>商品詳情</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx-JehSDwzt999IvR0WqCkfutAb5PTv2GaLG8kdhw_4qyEpCI9uJ6dFvGRVcT3N9gNe/exec";
const code = new URLSearchParams(location.search).get("code");

fetch(API_URL)
.then(res => res.json())
.then(data => {
  const p = data.products.find(x => x.code === code);
  if (!p) {
    document.body.innerHTML = "找不到商品";
    return;
  }

  let sizeHTML = "";
  ["baby","kids","elementary"].forEach(k=>{
    const s = p.sizes[k];
    if (s && s.options.length){
      sizeHTML += `<h3>${s.label}</h3>`;
      sizeHTML += s.options.map(o =>
        `<button onclick="selectSize('${s.label}','${o}','${s.salePrice}')">${o}</button>`
      ).join("");
    }
  });

  let colorHTML = p.colors.map(c => `
    <div>
      <div>${c.name}</div>
      ${c.swatch ? `<img src="${c.swatch}" width="40">` : ""}
      <div>
        ${c.images.map(img => `<img src="${img}" width="100">`).join("")}
      </div>
    </div>
  `).join("");

  document.body.innerHTML = `
    <img src="${p.mainImage}" width="300">
    <h1>${p.name}</h1>
    ${sizeHTML}
    <hr>
    ${colorHTML}
  `;
});

function selectSize(type, size, price){
  console.log(type, size, price);
}
</script>

</body>
</html>
