<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxI_TqRYEPdANgdW3z5npLGk39hTmMXOd3nS-vcPHrwrClr0viSszMX4KEG288zWCN1/exec";
const code = new URLSearchParams(location.search).get("code");

fetch(API_URL)
.then(r=>r.json())
.then(data=>{
  const p = data.products.find(x=>x.code===code);
  render(p);
});

function render(p){
  let sizeHTML = "";
  ["baby","kids","elementary"].forEach(k=>{
    const s = p.sizes[k];
    if(s && s.options.length){
      sizeHTML += `<h3>${s.label}</h3>`;
      sizeHTML += s.options.map(o=>
        `<button onclick="selectSize('${s.label}','${o}',${s.salePrice})">${o}</button>`
      ).join("");
    }
  });

  document.body.innerHTML = `
    <img src="${p.mainImage}">
    <h1>${p.name}</h1>
    ${sizeHTML}
  `;
}

function selectSize(type,size,price){
  console.log(type,size,price);
}
</script>
