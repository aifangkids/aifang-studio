<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AiFang Kids Studio</title>

<link href="https://fonts.googleapis.com/css2?family=Huninn&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Huninn','Noto Sans TC',sans-serif;
  background:#FCFBF8;
  color:#333;
  font-size:14px;
}
a{text-decoration:none;color:inherit}

/* Wrapper */
.wrapper{
  max-width:1200px;
  margin:0 auto;
  padding:20px;
}

/* ALL 按鈕 (手機) */
.filter-toggle{
  display:none;
  margin-bottom:10px;
  padding:8px 12px;
  background:#F6E3E3;
  border-radius:20px;
  cursor:pointer;
  text-align:center;
  font-weight:bold;
}

/* 外層布局 */
.content-wrapper{
  display:flex;
  gap:20px;
}

/* 側欄 */
.sidebar{
  width:200px;
}

.sidebar h3{
  margin-bottom:6px;
  font-size:14px;
}

.sidebar label{
  display:block;
  margin-bottom:4px;
  cursor:pointer;
}

.sidebar div.selected{
  font-weight:bold;
  color:#E38A8A;
}

/* 主要商品區 */
.product-main{
  flex:1;
}

/* 商品列表 Grid */
.product-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:30px 20px;
}

/* 手機單欄 & 側欄折疊 */
@media screen and (max-width:768px){
  .content-wrapper{
    flex-direction:row;
  }
  .filter-toggle{
    display:block;
  }
  .sidebar{
    width:150px;
    display:none;
    background:#fff;
    padding:10px;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,.1);
    position:fixed;
    top:60px;
    left:10px;
    z-index:100;
    max-height:80%;
    overflow:auto;
  }
  .sidebar.active{
    display:block;
  }
  .product-grid{
    grid-template-columns:1fr;
  }
}

/* 商品卡 */
.product-card{
  background:#fff;
  border-radius:22px;
  padding:14px;
  box-shadow:0 6px 18px rgba(0,0,0,.05);
}

.product-image-box{
  position:relative;
  margin-bottom:12px;
  cursor:pointer;
}

.product-image{
  width:100%;
  aspect-ratio:1/1.2;
  object-fit:cover;
  border-radius:18px;
  background:#f2f2f2;
}

/* 品牌標籤 */
.brand-tag{
  position:absolute;
  top:10px;
  left:10px;
  background:#333;
  color:#fff;
  font-size:11px;
  padding:3px 6px;
  border-radius:6px;
}

/* 色票 */
.product-swatches{
  display:flex;
  gap:6px;
  margin-top:6px;
}

.swatch{
  width:16px;
  height:16px;
  border-radius:50%;
  border:1px solid #ddd;
  overflow:hidden;
  flex-shrink:0;
}

.swatch img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

/* 商品文字 */
.product-name{
  font-size:15px;
  margin-bottom:6px;
}

/* 價格 */
.price-row{
  font-size:13px;
  line-height:1.6;
}

.price-row s{
  color:#aaa;
  margin-right:6px;
}

.price-row span{
  color:#E38A8A;
}

/* Footer */
footer{
  background:#e1d8d8;
  padding:20px 10px;
  margin-top:40px;
  font-size:13px;
  line-height:1.6;
}

.footer-content{
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  margin-bottom:10px;
}

.footer-left, .footer-right{
  max-width:48%;
}

.footer-bottom{
  text-align:center;
}

@media screen and (max-width:768px){
  .footer-content{
    flex-direction:column;
  }
  .footer-left, .footer-right{
    max-width:100%;
    margin-bottom:12px;
  }
  .footer-bottom{
    text-align:left;
  }
}
</style>
</head>
<!-- 回到頂部浮動按鈕 -->
<button id="backToTop" title="回到頂部">⬆</button>

<style>
#backToTop {
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 999;
  background: rgba(225, 216, 216, 0.8);
  color: #333;
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  font-size: 20px;
  cursor: pointer;
  display: none; /* 預設隱藏 */
  align-items: center;
  justify-content: center;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  transition: background 0.3s;
}

#backToTop:hover {
  background: rgba(225, 216, 216, 1);
}
</style>

<script>
// 顯示 / 隱藏回頂按鈕
window.addEventListener('scroll', () => {
  const btn = document.getElementById('backToTop');
  if(window.scrollY > 200){
    btn.style.display = 'flex';
  }else{
    btn.style.display = 'none';
  }
});

// 點擊平滑滾動到頂部
document.getElementById('backToTop').addEventListener('click', ()=>{
  window.scrollTo({top:0, behavior:'smooth'});
});
</script>

<body>

<!-- 頁首 Header -->
<header class="site-header">
  <div class="header-left">AiFangKids</div>
  <div class="header-center">
    <img id="site-logo" src="https://raw.githubusercontent.com/你的GitHub連結/LOGO.png" alt="Logo">
  </div>
  <div class="header-right">
    <a href="cart.html"><img src="https://cdn-icons-png.flaticon.com/512/34/34568.png" alt="Cart" class="cart-icon"></a>
  </div>
</header>

<style>
.site-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 20px;
  background:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
  position:sticky;
  top:0;
  z-index:200;
}

.header-left{
  font-size:18px;
  font-weight:bold;
}

.header-center img{
  height:50px; /* 可依需求調整 */
  width:auto;
}

.header-right .cart-icon{
  width:32px;
  height:32px;
}

/* 響應式 - 手機 */
@media screen and (max-width:768px){
  .site-header{
    flex-direction:row;
    justify-content:space-between;
  }
  .header-left{
    font-size:16px;
  }
  .header-center img{
    height:40px;
  }
  .header-right .cart-icon{
    width:28px;
    height:28px;
  }
}
</style>

<div class="wrapper">

  <div class="filter-toggle">ALL</div>

  <div class="content-wrapper">

    <!-- 側欄 -->
    <aside class="sidebar">
      <h3>品牌篩選</h3>
      <div id="brandFilter"></div>

      <h3>分類</h3>
      <div id="categoryFilter"></div>
    </aside>

    <!-- 商品主區 -->
    <main class="product-main">
      <div id="productGrid" class="product-grid"></div>
    </main>

  </div>
</div>

<!-- Footer -->
<footer>
  <div class="footer-content">
    <div class="footer-left">
      <strong>CUSTOMER CENTER</strong><br>
      MAIL: aifangkids@gmail.com<br>
      服務時間: AM 10:00 - PM 21:00<br>
      週末與國定假日休息，訂單及出貨將於工作日為您處理
    </div>
    <div class="footer-right">
      <strong>COMPANY INFO</strong><br>
      公司名稱: 璦坊童裝<br>
      統一編號: 95294390
    </div>
  </div>
  <div class="footer-bottom">
    © Aifang Kids Studio <span id="year"></span> | All rights reserved
  </div>
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx3Ob8gxHFXxcVwgY9LEUL71DLtuEfLfk0iw1dZ7dPGrmivVIMbUINBCIJUJirmK8AV/exec";
let allProducts = [];

/* 建立商品卡 - 價格 + 色票 */
function createPriceSwatchesDiv(product){
  const container = document.createElement('div');
  ["baby","kids","elementary"].forEach(k=>{
    const s = product.sizes[k];
    if(s && s.options.length){
      const priceRow = document.createElement('div');
      priceRow.className = 'price-row';
      priceRow.innerHTML = `${s.label}：<s>$${s.price}</s> <span>$${s.salePrice}</span>`;
      container.appendChild(priceRow);
    }
  });

  // 色票
  const swatchDiv = document.createElement('div');
  swatchDiv.className='product-swatches';
  product.colors.forEach(c=>{
    const span = document.createElement('span');
    span.className='swatch';
    if(c.type==='hex') span.style.background=c.value;
    else if(c.type==='image'){
      const img=document.createElement('img');
      img.src=c.value;
      span.appendChild(img);
    }
    swatchDiv.appendChild(span);
  });
  container.appendChild(swatchDiv);

  return container;
}

/* 渲染商品卡 */
function renderProducts(products){
  const grid = document.getElementById("productGrid");
  grid.innerHTML='';
  products.forEach(p=>{
    const card=document.createElement('div');
    card.className='product-card';

    // 主圖
    const imgBox=document.createElement('div');
    imgBox.className='product-image-box';
    const img=document.createElement('img');
    img.className='product-image';
    img.src=p.mainImage;
    imgBox.addEventListener('click',()=>{window.location.href=`detail.html?code=${p.code}`});
    imgBox.appendChild(img);

    // 品牌標籤
    const brandTag=document.createElement('div');
    brandTag.className='brand-tag';
    brandTag.textContent=p.brand;
    imgBox.appendChild(brandTag);

    card.appendChild(imgBox);

    // 商品名稱
    const nameDiv=document.createElement('div');
    nameDiv.className='product-name';
    nameDiv.textContent=p.name;
    card.appendChild(nameDiv);

    // 價格 + 色票
    card.appendChild(createPriceSwatchesDiv(p));

    grid.appendChild(card);
  });
}

/* 設定篩選 */
function setupFilters(products){
  const brandSet = Array.from(new Set(products.map(p=>p.brand))).sort();
  const categorySet = Array.from(new Set(products.map(p=>p.category))).sort();

  const brandFilterDiv = document.getElementById('brandFilter');
  const categoryFilterDiv = document.getElementById('categoryFilter');

  // 品牌 checkbox
  brandSet.forEach(b=>{
    const label = document.createElement('label');
    label.innerHTML=`<input type="checkbox" value="${b}"> ${b}`;
    brandFilterDiv.appendChild(label);
  });

  // 分類單選
  categorySet.forEach(c=>{
    const div = document.createElement('div');
    div.textContent=c;
    div.style.cursor='pointer';
    div.dataset.category=c;
    categoryFilterDiv.appendChild(div);
  });

  // 篩選函式
  function applyFilters(){
    const checkedBrands = Array.from(brandFilterDiv.querySelectorAll('input:checked')).map(i=>i.value);
    const selectedCategoryDiv = categoryFilterDiv.querySelector('.selected');
    const selectedCategory = selectedCategoryDiv ? [selectedCategoryDiv.dataset.category] : [];

    const filtered = products.filter(p=>{
      const brandMatch = checkedBrands.length===0 || checkedBrands.includes(p.brand);
      const categoryMatch = selectedCategory.length===0 || selectedCategory.includes(p.category);
      return brandMatch && categoryMatch;
    });
    renderProducts(filtered);
  }

  // 事件綁定
  brandFilterDiv.addEventListener('change',applyFilters);

  categoryFilterDiv.querySelectorAll('div').forEach(div=>{
    div.addEventListener('click',()=>{
      categoryFilterDiv.querySelectorAll('div').forEach(d=>d.classList.remove('selected'));
      div.classList.add('selected');
      applyFilters();
    });
  });
}

/* ALL 按鈕手機版 */
document.querySelector('.filter-toggle').addEventListener('click',()=>{
  document.querySelector('.sidebar').classList.toggle('active');
});

/* 取得資料 */
fetch(API_URL)
.then(r=>r.json())
.then(data=>{
  allProducts=data.products;
  setupFilters(allProducts);
  renderProducts(allProducts);
});

/* 自動填入年份 */
document.getElementById('year').textContent = new Date().getFullYear();
</script>

</body>
</html>
